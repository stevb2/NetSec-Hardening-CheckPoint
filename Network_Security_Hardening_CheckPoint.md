# Firewall Configuration and Network Security Hardening using Check Point

- **Description:** Setting up a virtual environment using **CheckPoint** to demonstrate configuring firewall rules, setting up intrusion prevention/detection systems (IPS/IDS), and securing a network.
- **Details:**
    - Includes firewall configurations.
    - Shows rules to block specific types of traffic or to detect intrusions.
    - Explains how the firewall improves overall network security, including log monitoring and reports.



### Downloading R80.20.10 Quantum Edge Image for ESXi

`https://support.checkpoint.com/results/download/109534`

### Initial Setup - 

WAN `VMnet10` - `NAT`
DMZ `VMnet11`
LAN1 `VMnet12` - `Host-Only`

Logging in to the WEB UI after performing initial setup

Default access policy blocks security risk categories
![Pasted image 20240921102328](https://github.com/user-attachments/assets/426f63ee-56e4-4aee-af60-c9c5e68cb5b3)

Navigation to restore factory defaults and update
![Pasted image 20240921103425](https://github.com/user-attachments/assets/63ad9cc2-3a51-4240-bf5e-1077dbe44923)

The Security Logs showing everything that is happening on the network
![Pasted image 20240921103643](https://github.com/user-attachments/assets/811b0057-ba92-4cd8-a7c1-2bf250d8bf35)

There is a status  monitoring dashboard with the current status on the gateway
![Pasted image 20240921104123](https://github.com/user-attachments/assets/cd3753f2-1f86-4fba-9254-28c2c2a6613d)

Some example filtering is enforcing SafeSearch and blocking the QUIC protocol (UDP/443) that bypasses SSL inspection in Google Search.

User awareness that connects with AD server
![Pasted image 20240921104809](https://github.com/user-attachments/assets/95ac0f82-064e-4b5a-8e55-1ecc62c60f1c)


In order to block web traffic categories SSL inspection should be enabled. This can be bypassed for certain categories) and categorized as 'light SSL'.
- Health
- Government/Military
- Financial Services
- Media Streams
- Microsoft Updates
![Pasted image 20240921105226](https://github.com/user-attachments/assets/53c2db42-5833-4b34-98c4-4b2b4d8799d3)


Downloading the certificate generated by Check Point
![Pasted image 20240921105333](https://github.com/user-attachments/assets/558b3c6e-4879-4741-8217-d960393aab73)


Internet Options > Content > Certificates
Trusted Root Certification Authorities
Importing Certificate Wizard
There will be a warning message to trust the certificate which can be accepted.

Viewing HTTPS Inspection in the Logs 
![Pasted image 20240921110220](https://github.com/user-attachments/assets/88c241fe-7e0c-45e2-898c-bb6e19b79ae6)


There is an option to block types of web traffic using categories or specific applications
![Pasted image 20240921112153](https://github.com/user-attachments/assets/dddc8a3b-70ce-4e01-9af6-9f2601e20397)
![Pasted image 20240921112033](https://github.com/user-attachments/assets/a7f0365a-f7a8-4016-96b8-698ad8d11fd3)


### Threat Emulation

There is the default option to use Check Point public threat cloud, which will send suspicious files to the be emulated and scanned and blocked. 
There is another option to set up a Private Cloud (on-premises Sandblast Threat Emulation)

Setting the threat prevention scopes, all the blades are enabled and up to date
![Pasted image 20240921110849](https://github.com/user-attachments/assets/978f4184-d77e-4719-b093-92427a852ea5)


### IPS Protections
IPS Protection Types
![Pasted image 20240921110926](https://github.com/user-attachments/assets/f26c5e56-eb79-4ba1-92db-71d666465e46)

The threat prevention engine scanning can be configured with options.
- Scope
	- incoming files from External and DMZ interfaces
	- incoming and outgoing files
- Protocols
	- HTTP
	- Mail
- Handling
	- Background - connections are allowed until emulation handling is complete
	- Hold - connections are blocked until emulation handling is complete

Testing IPS with nmap
![Pasted image 20240921162737](https://github.com/user-attachments/assets/f2e5d485-c57f-404a-b5e2-0b8f1db352d4)

The IPS detected and filtered the nmap scan
![Pasted image 20240921162823](https://github.com/user-attachments/assets/c92f9b28-6375-4e16-92f9-68f65c41d4f1)

The details in the network logs
![Pasted image 20240921162913](https://github.com/user-attachments/assets/b236ffcf-89ba-4123-a2ff-dd7e6ad6d567)
